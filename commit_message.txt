Refactor: Separate conversion logic into dedicated classes